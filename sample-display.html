<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>样片展示 - 无人机自助打卡</title>
    <link href="assets/css/tailwind-custom.css" rel="stylesheet">
    <link href="assets/css/font-awesome.min.css" rel="stylesheet">
    <link href="assets/css/inter-font.css" rel="stylesheet">

</head>
<body class="font-inter bg-light text-dark antialiased touch-action-manipulation">
    <div class="min-h-screen w-full pb-16 safe-area-bottom">
        <!-- 顶部导航栏 -->
        <header class="sticky top-0 left-0 right-0 bg-white z-30 border-b border-gray-light">
            <div class="container mx-auto px-4 py-3 flex justify-center items-center">
                <h1 class="text-lg font-medium">样片展示</h1>
            </div>
        </header>

        <!-- 分类筛选 -->
        <div class="sticky top-12 left-0 right-0 bg-white z-20 px-4 py-3 border-b border-gray-light">
            <div class="flex space-x-2 overflow-x-auto pb-1 scrollbar-hide">
                <button class="filter-btn flex-shrink-0 px-4 py-2 bg-primary text-white rounded-full text-sm font-medium whitespace-nowrap touch-friendly" data-filter="all">
                    <i class="fa fa-th-large mr-1"></i>全部
                </button>
                <button class="filter-btn flex-shrink-0 px-4 py-2 bg-gray-100 text-dark rounded-full text-sm font-medium whitespace-nowrap touch-friendly" data-filter="mountain">
                    <i class="fa fa-flag mr-1"></i>山顶景观
                </button>
                <button class="filter-btn flex-shrink-0 px-4 py-2 bg-gray-100 text-dark rounded-full text-sm font-medium whitespace-nowrap touch-friendly" data-filter="lake">
                    <i class="fa fa-tint mr-1"></i>湖畔风光
                </button>
                <button class="filter-btn flex-shrink-0 px-4 py-2 bg-gray-100 text-dark rounded-full text-sm font-medium whitespace-nowrap touch-friendly" data-filter="city">
                    <i class="fa fa-building mr-1"></i>城市地标
                </button>
                <button class="filter-btn flex-shrink-0 px-4 py-2 bg-gray-100 text-dark rounded-full text-sm font-medium whitespace-nowrap touch-friendly" data-filter="forest">
                    <i class="fa fa-tree mr-1"></i>森林公园
                </button>
            </div>
        </div>

        <!-- 样片网格 -->
        <div class="px-4 py-4 miniprogram-scroll">
            <div class="grid grid-cols-2 gap-3">
                <!-- 视频样片1 - 山顶俯拍全景 -->
                <div class="gallery-item miniprogram-card overflow-hidden touch-friendly" data-category="mountain" onclick="openModal('山顶俯拍全景', '360度环绕拍摄，展现壮丽山景，包含日出时分的金色光影效果', 'assets/images/mountain-1015.jpg', 'video', 'mountain')">
                    <div class="relative">
                        <img src="assets/images/mountain-1015.jpg" alt="山顶俯拍全景" class="w-full h-32 object-cover">
                        <div class="absolute top-2 right-2 bg-accent/90 backdrop-blur-sm rounded-full px-2 py-1 text-xs text-white">
                            <i class="fa fa-play mr-1"></i> 视频
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm flex items-center justify-center">
                                <i class="fa fa-play text-white"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2">
                            <div class="text-white text-xs font-medium">3:20</div>
                        </div>
                    </div>
                    <div class="p-3">
                        <h4 class="font-medium text-sm mb-1">山顶俯拍全景</h4>
                        <p class="text-gray-medium text-xs mb-2">天台山观景台</p>
                        <div class="flex justify-between items-center">
                            <div class="text-xs text-primary">
                                <i class="fa fa-star mr-1"></i> 4.9 (128)
                            </div>
                            <div class="text-xs text-gray-medium">¥128</div>
                        </div>
                    </div>
                </div>
                
                <!-- 视频样片2 - 湖畔追踪拍摄 -->
                <div class="gallery-item miniprogram-card overflow-hidden touch-friendly" data-category="lake" onclick="openModal('湖畔追踪拍摄', '智能跟拍功能，捕捉湖边漫步的美好瞬间，配合夕阳余晖', 'assets/images/lake-1031.jpg', 'video', 'lake')">
                    <div class="relative">
                        <img src="assets/images/lake-1031.jpg" alt="湖畔追踪拍摄" class="w-full h-32 object-cover">
                        <div class="absolute top-2 right-2 bg-accent/90 backdrop-blur-sm rounded-full px-2 py-1 text-xs text-white">
                            <i class="fa fa-play mr-1"></i> 视频
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm flex items-center justify-center">
                                <i class="fa fa-play text-white"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2">
                            <div class="text-white text-xs font-medium">2:45</div>
                        </div>
                    </div>
                    <div class="p-3">
                        <h4 class="font-medium text-sm mb-1">湖畔追踪拍摄</h4>
                        <p class="text-gray-medium text-xs mb-2">西湖景区</p>
                        <div class="flex justify-between items-center">
                            <div class="text-xs text-primary">
                                <i class="fa fa-star mr-1"></i> 4.8 (96)
                            </div>
                            <div class="text-xs text-gray-medium">¥98</div>
                        </div>
                    </div>
                </div>
                
                <!-- 视频样片3 - 城市夜景航拍 -->
                <div class="gallery-item miniprogram-card overflow-hidden touch-friendly" data-category="city" onclick="openModal('城市夜景航拍', '现代都市灯火辉煌，夜景航拍展现城市魅力', 'assets/images/city-1016.jpg', 'video', 'city')">
                    <div class="relative">
                        <img src="assets/images/city-1016.jpg" alt="城市夜景航拍" class="w-full h-32 object-cover">
                        <div class="absolute top-2 right-2 bg-accent/90 backdrop-blur-sm rounded-full px-2 py-1 text-xs text-white">
                            <i class="fa fa-play mr-1"></i> 视频
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm flex items-center justify-center">
                                <i class="fa fa-play text-white"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2">
                            <div class="text-white text-xs font-medium">4:10</div>
                        </div>
                    </div>
                    <div class="p-3">
                        <h4 class="font-medium text-sm mb-1">城市夜景航拍</h4>
                        <p class="text-gray-medium text-xs mb-2">城市中心广场</p>
                        <div class="flex justify-between items-center">
                            <div class="text-xs text-primary">
                                <i class="fa fa-star mr-1"></i> 4.7 (82)
                            </div>
                            <div class="text-xs text-gray-medium">¥158</div>
                        </div>
                    </div>
                </div>
                
                <!-- 视频样片4 - 森林俯拍 -->
                <div class="gallery-item miniprogram-card overflow-hidden touch-friendly" data-category="forest" onclick="openModal('森林俯拍', '绿意盎然的自然画卷，展现大自然的美丽', 'assets/images/forest-1020.jpg', 'video', 'forest')">
                    <div class="relative">
                        <img src="assets/images/forest-1020.jpg" alt="森林俯拍" class="w-full h-32 object-cover">
                        <div class="absolute top-2 right-2 bg-accent/90 backdrop-blur-sm rounded-full px-2 py-1 text-xs text-white">
                            <i class="fa fa-play mr-1"></i> 视频
                        </div>
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-10 h-10 rounded-full bg-black/50 backdrop-blur-sm flex items-center justify-center">
                                <i class="fa fa-play text-white"></i>
                            </div>
                        </div>
                        <div class="absolute bottom-0 left-0 right-0 bg-gradient-to-t from-black/60 to-transparent p-2">
                            <div class="text-white text-xs font-medium">2:30</div>
                        </div>
                    </div>
                    <div class="p-3">
                        <h4 class="font-medium text-sm mb-1">森林俯拍</h4>
                        <p class="text-gray-medium text-xs mb-2">翠竹森林公园</p>
                        <div class="flex justify-between items-center">
                            <div class="text-xs text-primary">
                                <i class="fa fa-star mr-1"></i> 4.6 (74)
                            </div>
                            <div class="text-xs text-gray-medium">¥88</div>
                        </div>
                    </div>
                </div>
            </div>



            <!-- 加载更多 -->
            <div class="text-center py-8 mb-16">
                <button id="load-more" class="px-6 py-3 bg-white miniprogram-card text-gray-medium font-medium touch-friendly">
                    <i class="fa fa-refresh mr-2"></i>加载更多样片
                </button>
            </div>
        </div>
    </div>

    <!-- 样片详情模态框 -->
    <div id="gallery-detail-modal" class="fixed inset-0 bg-black/90 z-50 hidden flex items-center justify-center">
        <button id="close-gallery-detail" class="fixed top-8 right-4 text-white p-2 z-10 touch-friendly">
            <i class="fa fa-times text-xl"></i>
        </button>
        <div class="w-full max-w-sm mx-4">
            <div class="relative mb-4 rounded-lg overflow-hidden">
                <img id="gallery-detail-img" src="" alt="样片详情" class="w-full h-64 object-cover">
                <div id="play-overlay" class="absolute inset-0 flex items-center justify-center">
                    <div class="w-16 h-16 rounded-full bg-accent/80 flex items-center justify-center">
                        <i class="fa fa-play text-white text-xl"></i>
                    </div>
                </div>
            </div>
            <div class="text-center">
                <h2 id="gallery-detail-title" class="text-white text-lg font-bold mb-2">样片标题</h2>
                <p id="gallery-detail-desc" class="text-white/80 text-sm mb-4">样片描述</p>
                <div class="flex justify-center space-x-4 mb-4">
                    <div class="text-white text-sm">
                        <i class="fa fa-video-camera mr-1"></i> <span id="detail-type">视频</span>
                    </div>
                    <div class="text-white text-sm">
                        <i class="fa fa-star mr-1"></i> <span id="detail-rating">4.9</span>
                    </div>
                </div>
                
                <!-- 分享和点赞按钮 -->
                <div class="flex justify-center space-x-4 mb-4">
                    <button id="like-btn" onclick="toggleLike()" class="flex items-center px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-full transition-colors touch-friendly">
                        <i id="like-icon" class="fa fa-star-o mr-2"></i>
                        <span id="like-text">点赞</span>
                    </button>
                    <button onclick="shareVideo()" class="flex items-center px-4 py-2 bg-white/10 hover:bg-white/20 text-white rounded-full transition-colors touch-friendly">
                        <i class="fa fa-share-alt mr-2"></i>分享
                    </button>
                </div>
                
                <button onclick="goToShooting()" class="w-full py-3 bg-primary text-white rounded-lg font-medium touch-friendly">
                    <i class="fa fa-rocket mr-2"></i>选择此效果拍摄
                </button>
            </div>
        </div>
    </div>

    <!-- 微信小程序底部导航栏 -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-light z-50 safe-area-bottom" id="bottomNav">
        <div class="flex justify-around items-center h-16">
            <div class="tab-item flex flex-col items-center justify-center text-gray-medium touch-friendly" onclick="location.href='index.html'">
                <i class="fa fa-home text-lg mb-1"></i>
                <span class="text-xs">首页</span>
            </div>
            <div class="tab-item flex flex-col items-center justify-center text-primary touch-friendly active">
                <i class="fa fa-picture-o text-lg mb-1"></i>
                <span class="text-xs">样片</span>
            </div>
            <div class="tab-item flex flex-col items-center justify-center touch-friendly" onclick="location.href='user-selection.html'">
                <div class="w-12 h-12 rounded-full bg-primary text-white flex items-center justify-center -mt-6 shadow-lg relative">
                    <i class="fa fa-camera text-lg"></i>
                </div>
                <span class="text-xs text-primary font-medium mt-1">拍摄</span>
            </div>
            <div class="tab-item flex flex-col items-center justify-center text-gray-medium touch-friendly" onclick="checkLoginAndGoToOrders()">
                <i class="fa fa-user text-lg mb-1"></i>
                <span class="text-xs">订单</span>
            </div>
            <div class="tab-item flex flex-col items-center justify-center text-gray-medium touch-friendly" onclick="checkLoginAndGoToCustomize()">
                <i class="fa fa-star text-lg mb-1"></i>
                <span class="text-xs">定制</span>
            </div>
        </div>
    </nav>





    <!-- JavaScript交互代码 -->
    <script>
        // 小程序样式初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 添加小程序风格的触摸反馈
            const touchElements = document.querySelectorAll('.touch-friendly');
            touchElements.forEach(element => {
                element.addEventListener('touchstart', function() {
                    this.style.opacity = '0.7';
                    this.style.transform = 'scale(0.95)';
                });
                
                element.addEventListener('touchend', function() {
                    this.style.opacity = '1';
                    this.style.transform = 'scale(1)';
                });
                
                element.addEventListener('touchcancel', function() {
                    this.style.opacity = '1';
                    this.style.transform = 'scale(1)';
                });
            });
        });

        // DOM元素获取
        const filterBtns = document.querySelectorAll('.filter-btn');
        const galleryItems = document.querySelectorAll('.gallery-item');
        const galleryDetailModal = document.getElementById('gallery-detail-modal');
        const closeGalleryDetail = document.getElementById('close-gallery-detail');
        const galleryDetailImg = document.getElementById('gallery-detail-img');
        const galleryDetailTitle = document.getElementById('gallery-detail-title');
        const galleryDetailDesc = document.getElementById('gallery-detail-desc');
        const detailType = document.getElementById('detail-type');
        const detailRating = document.getElementById('detail-rating');
        const playOverlay = document.getElementById('play-overlay');
        const loadMore = document.getElementById('load-more');
        
        // 分类筛选功能
        filterBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                // 更新按钮状态
                filterBtns.forEach(b => {
                    b.classList.remove('bg-primary', 'text-white');
                    b.classList.add('bg-gray-100', 'text-dark');
                });
                this.classList.remove('bg-gray-100', 'text-dark');
                this.classList.add('bg-primary', 'text-white');
                
                // 筛选样片
                const filter = this.dataset.filter;
                galleryItems.forEach(item => {
                    if (filter === 'all' || item.dataset.category.includes(filter)) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
                
                // 小程序触觉反馈
                if (typeof wx !== 'undefined') {
                    wx.vibrateShort({
                        type: 'light'
                    });
                }
            });
        });
        
        // 打开样片详情模态框
        function openModal(title, desc, imgSrc, type, category) {
            galleryDetailTitle.textContent = title;
            galleryDetailDesc.textContent = desc;
            galleryDetailImg.src = imgSrc;
            detailType.textContent = type === 'video' ? '视频' : '照片';
            detailRating.textContent = (Math.random() * 0.5 + 4.5).toFixed(1);
            
            // 存储当前样片的地点类型，用于跳转时传递
            window.currentSampleCategory = category;
            
            galleryDetailModal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            
            // 小程序触觉反馈
            if (typeof wx !== 'undefined') {
                wx.vibrateShort({
                    type: 'medium'
                });
            }
        }
        
        // 关闭样片详情
        closeGalleryDetail.addEventListener('click', function() {
            galleryDetailModal.classList.add('hidden');
            document.body.style.overflow = 'auto';
        });
        
        // 点击模态框背景关闭
        galleryDetailModal.addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
                document.body.style.overflow = 'auto';
            }
        });
        
        // 加载更多功能
        loadMore.addEventListener('click', function() {
            this.innerHTML = '<i class="fa fa-spinner fa-spin mr-2"></i>加载中...';
            this.disabled = true;
            
            // 模拟加载更多
            setTimeout(() => {
                this.innerHTML = '<i class="fa fa-refresh mr-2"></i>加载更多样片';
                this.disabled = false;
                
                // 小程序提示
                if (typeof wx !== 'undefined') {
                    wx.showToast({
                        title: '已加载更多样片',
                        icon: 'success',
                        duration: 1500
                    });
                }
            }, 1500);
        });
        
        // 点赞功能
        let isLiked = false;
        function toggleLike() {
            const likeIcon = document.getElementById('like-icon');
            const likeText = document.getElementById('like-text');
            const likeBtn = document.getElementById('like-btn');
            
            isLiked = !isLiked;
            
            if (isLiked) {
                likeIcon.className = 'fa fa-star mr-2';
                likeText.textContent = '已点赞';
                likeBtn.classList.add('bg-yellow-500/20');
                likeBtn.classList.remove('bg-white/10');
                
                // 小程序触觉反馈和提示
                if (typeof wx !== 'undefined') {
                    wx.vibrateShort({
                        type: 'heavy'
                    });
                    wx.showToast({
                        title: '点赞成功',
                        icon: 'success',
                        duration: 1000
                    });
                }
            } else {
                likeIcon.className = 'fa fa-star-o mr-2';
                likeText.textContent = '点赞';
                likeBtn.classList.remove('bg-yellow-500/20');
                likeBtn.classList.add('bg-white/10');
                
                // 小程序触觉反馈
                if (typeof wx !== 'undefined') {
                    wx.vibrateShort({
                        type: 'light'
                    });
                }
            }
        }
        
        // 分享功能
        function shareVideo() {
            const title = document.getElementById('gallery-detail-title').textContent;
            
            // 小程序分享
            if (typeof wx !== 'undefined') {
                wx.showShareMenu({
                    withShareTicket: true,
                    success: function() {
                        wx.showToast({
                            title: '分享成功',
                            icon: 'success',
                            duration: 1500
                        });
                    }
                });
                
                // 触觉反馈
                wx.vibrateShort({
                    type: 'medium'
                });
            } else {
                // 普通浏览器环境的分享功能
                if (navigator.share) {
                    navigator.share({
                        title: title,
                        text: '推荐一个很棒的无人机拍摄样片',
                        url: window.location.href
                    }).then(() => {
                        console.log('分享成功');
                    }).catch((error) => {
                        console.log('分享失败', error);
                        showShareModal();
                    });
                } else {
                    showShareModal();
                }
            }
        }
        
        // 显示分享选项模态框（备用方案）
        function showShareModal() {
            const shareText = `推荐一个很棒的无人机拍摄样片：${document.getElementById('gallery-detail-title').textContent}`;
            
            // 创建临时文本区域并复制链接
            const textArea = document.createElement('textarea');
            textArea.value = shareText + ' ' + window.location.href;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand('copy');
            document.body.removeChild(textArea);
            
            // 显示提示
            alert('链接已复制到剪贴板，可以分享给好友！');
        }

        // 跳转到拍摄页面并传递样片信息
        function goToShooting() {
            const category = window.currentSampleCategory || 'mountain'; // 默认选择山景
            location.href = `user-selection.html?sample=${category}`;
        }

        // 检查登录状态并跳转到订单页面
        function checkLoginAndGoToOrders() {
            const loginInfo = JSON.parse(localStorage.getItem('loginInfo') || '{}');
            if (!loginInfo.isLoggedIn) {
                // 未登录，设置返回URL并跳转到登录页面
                localStorage.setItem('returnUrl', 'user-management.html');
                location.href = 'login.html';
            } else {
                // 已登录，直接跳转到订单页面
                location.href = 'user-management.html';
            }
        }

        // 检查登录状态并跳转到定制页面
        function checkLoginAndGoToCustomize() {
            const loginInfo = JSON.parse(localStorage.getItem('loginInfo') || '{}');
            if (!loginInfo.isLoggedIn) {
                // 未登录，设置返回URL并跳转到登录页面
                localStorage.setItem('returnUrl', 'after-service.html');
                location.href = 'login.html';
            } else {
                // 已登录，直接跳转到定制页面
                location.href = 'after-service.html';
            }
        }

    </script>
</body>
</html>
